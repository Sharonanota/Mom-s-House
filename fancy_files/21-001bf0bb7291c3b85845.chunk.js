(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{78:function(t,e,a){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(r=(i=s.next()).done)&&(a.push(i.value),!e||a.length!==e);r=!0);}catch(u){n=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(n)throw o}}return a}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return n(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return n(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){s(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function u(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.baseState={sort:"best",license:"all",orientation:[],editor:!1,page:1,image_style:[],num_people:[],people_age:[],people_composition:[],ethnicity:[],resolution:[],aspect_ratio:[],duration:"25_90",color:"",threshold:"",wholly_owned:!1},this.defaultState=JSON.parse(JSON.stringify(this.baseState)),this.omittedArray=["content"],this.updateStateFromURL()}var e,a,n;return e=t,(a=[{key:"updateStateFromURL",value:function(){var t=this.returnURLParamState(),e=this.getRawStateString();!e&&t?this.assignDefaultsWithParams(t):e&&t?this.assignDefaultsWithParams(i(i({},this.getRawStateObject()),t)):e||t||this.assignDefaultsWithParams({})}},{key:"addPopStateListener",value:function(){var t=this;window.addEventListener("popstate",(function(){t.updateStateFromURL()}))}},{key:"assignDefaultsWithParams",value:function(t){if(!t)throw new Error("No state object was given.");this.saveStateToSession(i(i({},this.defaultState),t))}},{key:"returnURLParamState",value:function(){var t=window.location.search.substring(1),e={},a=null;t.split("&").forEach((function(t){var a=t.split("="),r=a.shift(),n=a.join("=");e[r]=decodeURIComponent(n)}));for(var n=Object.keys(e),o=0;o<n.length;o+=1){var i=n[o],s=i.split("-");if(Object.hasOwnProperty.call(this.defaultState,s[0])){var u=Object.prototype.toString.call(this.defaultState[s[0]]);if(null===a&&(a={}),s.length>1){var c=r(s,2),l=c[0],f=c[1];switch(u){case"[object Array]":"undefined"===typeof a[l]&&(a[l]=[]),a[l].push(f);break;default:a[l]=f}}else try{a[s[0]]=JSON.parse(e[i])}catch(h){a[s[0]]=e[i]}}}return a||!1}},{key:"setNewDefaultState",value:function(t){this.defaultState=t,this.saveStateToSession(this.defaultState)}},{key:"setDefaultState",value:function(){this.defaultState=JSON.parse(JSON.stringify(this.baseState)),this.saveStateToSession(this.defaultState)}},{key:"getRawStateString",value:function(){return sessionStorage.getItem("ezSearchState")||!1}},{key:"saveStateToSession",value:function(t){var e=JSON.stringify(t);sessionStorage.setItem("ezSearchState",e)}},{key:"getDefaultStateObject",value:function(){return this.defaultState}},{key:"getRawStateObject",value:function(){return i({},JSON.parse(this.getRawStateString()))}},{key:"getRawParamKeys",value:function(){var t=this.getRawStateObject();return this.flattenParamKeys(t)}},{key:"getParamKeys",value:function(){var t=this.getState();return this.flattenParamKeys(t)}},{key:"flattenParamKeys",value:function(t){var e=this,a=Object.keys(t),r=[];return a.forEach((function(a){if("duration"!==a)switch(Object.prototype.toString.call(t[a])){case"[object Boolean]":!0===t[a]&&r.push("".concat(a));break;case"[object Number]":t[a]!==e.defaultState[a]&&r.push("".concat(a));break;case"[object Array]":t[a].length>0&&t[a].forEach((function(t){r.push("".concat(a,"-").concat(t))}));break;case"[object String]":r.push("".concat(a,"-").concat(t[a]))}else r.push("".concat(a))})),r}},{key:"generateFlatQueryString",value:function(t){var e=this.getRawStateObject(),a="",r=0;return t.forEach((function(t){"number"===typeof e[t]||"duration"===t?a+="".concat(0===r?"?":"&").concat(encodeURIComponent(t),"=").concat(e[t]):a+="".concat(0===r?"?":"&").concat(encodeURIComponent(t),"=true"),r+=1})),a}},{key:"getRawFlatQueryString",value:function(){var t=this.getRawParamKeys();return this.generateFlatQueryString(t)}},{key:"getFlatQueryString",value:function(){var t=this.getParamKeys();return this.generateFlatQueryString(t)}},{key:"getState",value:function(){var t=this.getRawStateObject();return i({},this.filterDefaults(t))}},{key:"filterDefaults",value:function(t){var e=this,a={};return Object.keys(t).forEach((function(r){e.deepCompare(t[r],e.defaultState[r])||(a[r]=t[r])})),a}},{key:"deepCompare",value:function(t,e){return JSON.stringify(t)===JSON.stringify(e)}},{key:"omittedFromState",value:function(t){return this.omittedArray.includes(t)}},{key:"updateStateValue",value:function(t,e){var a=this.getRawStateObject(),r=a;if("undefined"===typeof a[t])throw new Error("State key does not exist");if(typeof a[t]!==typeof e&&"boolean"!==typeof e)throw new Error("New value typeof does not match current state. typeof state: ".concat(typeof a[t],", typeof value: ").concat(typeof e));r[t]=e,"page"!==t&&(r.page=this.defaultState.page),this.saveStateToSession(r)}},{key:"updateParamKey",value:function(t){var e=this.getRawStateObject();if("boolean"!==typeof e[t]){if(-1===t.indexOf("-"))throw new Error("Param key cannot be split");var a=r(t.split("-"),2),n=a[0],o=a[1];"[object Array]"===Object.prototype.toString.call(e[n])?this.pushToStateArray(n,o):this.updateStateValue(n,o)}else this.updateStateValue(t,!0)}},{key:"removeParamKey",value:function(t){var e=this.getRawStateObject();if("boolean"!==typeof e[t]){if(-1===t.indexOf("-"))throw new Error("Param key cannot be split");var a=r(t.split("-"),2),n=a[0],o=a[1];"[object Array]"===Object.prototype.toString.call(e[n])?this.removeFromStateArray(n,o):this.updateStateValue(n,this.defaultState[n])}else this.updateStateValue(t,!1)}},{key:"removeFromStateArray",value:function(t,e){var a=this.getRawStateObject(),r=a;if("[object Array]"!==Object.prototype.toString.call(a[t]))throw new Error("State key is not an array");if(!a[t].includes(e))throw new Error("Value does not exist in state");r[t]=a[t].filter((function(t){return t!==e})),0===r[t].length&&(r[t]=this.defaultState[t]),"page"!==t&&(r.page=this.defaultState.page),this.saveStateToSession(r)}},{key:"pushToStateArray",value:function(t,e){var a=this.getRawStateObject(),r=a;if("string"!==typeof e)throw new Error("array values must be strings");if("[object Array]"!==Object.prototype.toString.call(a[t]))throw new Error("State key is not an array");if(a[t].includes(e))throw new Error("Value already exists in state");this.deepCompare(a[t],this.defaultState[t])&&(r[t]=[]),r[t].push(e),"page"!==t&&(r.page=this.defaultState.page),this.saveStateToSession(r)}},{key:"resetKeyToDefault",value:function(t){var e=this.getRawStateObject();if(!this.defaultState[t])throw Error("This key does not have a default");e[t]=this.defaultState[t],this.saveStateToSession(e)}},{key:"resetStateToDefault",value:function(){this.saveStateToSession(this.defaultState),sessionStorage.setItem("user_filter_order","[]")}}])&&u(e.prototype,a),n&&u(e,n),t}();e.a=c}}]);
//# sourceMappingURL=21-001bf0bb7291c3b85845.chunk.js.map