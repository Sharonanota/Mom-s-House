(window.webpackJsonp=window.webpackJsonp||[]).push([[183],{1420:function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return b}));var n=r(13),a=r(9),o=r.n(a),i=r(2),u=r(89),c=r(7),s=r(8);function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=g(t);if(e){var a=g(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d(this,r)}}function d(t,e){return!e||"object"!==typeof e&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var b=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(d,t);var e,r,n,a=f(d);function d(){return p(this,d),a.apply(this,arguments)}return e=d,(r=[{key:"connect",value:function(){this.impactRadiusUrl=this.element.getAttribute("data-impact-radius-url"),this.impactRadiusSearchPopupUrl=this.element.getAttribute("data-impact-radius-search-popup-url")}},{key:"maybePagination",value:function(t){if(this.mode="pagination",this.shouldShowPopup()){var e=this.getNavigationPage(t.target);if(Object(i.N)("istock-alt-popup-triggers")){var r=o.a.get("partner_popup_pagination")||0,n=parseInt(r,10)+1;if(o.a.set("partner_popup_pagination",n,{expires:Object(u.g)()}),n<2)return}this.hasSearchValues&&Object(c.k)({data:{action:s.vb,label:"Terms-".concat(this.termsValue),value:e,partner_popup_origin:this.sourceValue}}),Object(u.d)(this.partnerUrl())}}},{key:"getNavigationPage",value:function(t){if(!t||!this.hasCurrentPageTarget)return this.pageValue;if(t===this.currentPageTarget){var e=parseInt(Object(i.j)(this.currentPageTarget),10);return e>this.totalPagesValue?this.totalPagesValue:e}return this.pageValue}},{key:"maybeSearch",value:function(){Object(i.N)("istock-alt-popup-triggers")||!Object(i.p)()&&this.shouldShowPopup()&&this.isLucky()&&(this.mode="search",Object(u.d)(this.partnerUrl()))}},{key:"shouldShowPopup",value:function(){return Object(i.N)("istock-alt-popup-triggers")?Object(u.a)()&&!Object(u.e)():!Object(u.e)()}},{key:"isLucky",value:function(){return 3===this.randomNumber()}},{key:"randomNumber",value:function(){return Math.floor(5*Math.random())+1}},{key:"searchTerm",get:function(){var t=document.querySelector("[data-controller~='search-form']");if(!t)return null;if("pagination"===this.mode)return t.getAttribute("data-search-term").replace(/-/g," ");var e=t.querySelector("input[name=search]");return e?e.value:null}},{key:"partnerUrl",value:function(){switch(this.mode){case"search":return this.makePopupUrl(encodeURIComponent(this.subId1()));case"pagination":return this.makePopupUrl("pagination");default:return null}}},{key:"makePopupUrl",value:function(t){var e={u:encodeURIComponent(this.destinationUrl),sharedid:window.location.hostname,subId1:"".concat(t).concat(Object(u.f)()),subId2:this.subId2(),subId3:this.subId3(),adtype:this.adType,adplacement:"POP"},r="";switch(this.mode){case"search":r=this.impactRadiusSearchPopupUrl;break;case"pagination":r=this.impactRadiusUrl;break;default:r=this.impactRadiusUrl}return"".concat(r,"?").concat(Object.keys(e).map((function(t){return"".concat(t,"=").concat(e[t])})).join("&"))}},{key:"subId1",value:function(){return"pagination"===this.mode?"pagination":document.body.classList.contains("home-home_vectors")?"SearchPopHome":this.isShowPage?"SearchPopShow":this.isSearchPage?"SearchPopSearch":"SearchPopOther"}},{key:"subId2",value:function(){return document.body.getAttribute("data-pageview-guid")}},{key:"subId3",value:function(){return"pagination"===this.mode?this.getNavigationPage():"".concat(this.searchTerm,"_null_").concat(this.mode,"pop")}},{key:"hasSearchValues",get:function(){return this.hasTermsValue&&this.hasPageValue&&this.hasSourceValue}},{key:"destinationUrl",get:function(){return this.element.getAttribute("data-destination-url").replace(/{{search_term}}/g,this.searchTerm)}},{key:"adType",get:function(){return o.a.get("content_type")||"vector"}},{key:"isSearchPage",get:function(){return document.body.classList.contains("searches-show")}},{key:"isShowPage",get:function(){return document.body.classList.contains("resources-show")}}])&&h(e.prototype,r),n&&h(e,n),d}(n.a);b.targets=["currentPage"],b.values={terms:String,page:Number,totalPages:Number,source:String}}}]);
//# sourceMappingURL=partner-popup-controller-6e36f871f849e435ab1d.chunk.js.map