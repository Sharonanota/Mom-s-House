(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{494:function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return g}));var n=r(13),o=r(2),i=r(7),a=r(8),c=r(18);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=m(t);if(e){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(t,e){return!e||"object"!==typeof e&&"function"!==typeof e?v(t):e}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var y=new(r(40).a),g=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(b,t);var e,n,s,l=h(b);function b(){var t;p(this,b);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=l.call.apply(l,[this].concat(n))).setNewThumbnailInfo=function(){t.setupContribInfoTooltips()},t.hoverThumb=function(e){var r=e.target.dataset;if("false"===r.templateLoaded){var n={url:r.uploadsPath,user_id:r.userId,user_display_name:r.userDisplayName,contributor_uploads_path:r.uploadsPath,contributor_avatar_src:r.avatarSrc},i=t.hoverTemplateTarget.innerHTML;if(i=Object(o.z)(i,n),e.target.insertAdjacentHTML("beforeend",i),r.avatarSrc){var a={src:r.avatarSrc},c=e.target.querySelector(".ez-avatar"),s=e.target.querySelector('[data-thumbnail-contributor-info-target="avatarTemplate"]');c.classList.remove("ez-avatar--missing"),c.innerHTML=Object(o.z)(s.innerHTML,a)}if(r.removePath&&t.hasRemoveFromCollectionTarget){var u={url:r.removePath,remove_text:r.removeText,remove_path:r.removePath},l=e.target.querySelector('[data-thumbnail-contributor-info-target="contribInfo"]'),p=t.removeFromCollectionTarget.innerHTML;p=Object(o.z)(p,u),l.insertAdjacentHTML("beforeend",p)}t.hasContribThumbnailsTarget&&t.setupFollowingThumbnails(),t.tooltipsInitialized=!1,y.addMediaQuery("(min-width: 1024px)",t.initTooltips),y.evaluateAll(),y.addListeners(),r.templateLoaded="true"}},t.initTooltips=function(){if(!t.tooltipsInitialized){var e=v(t),n=t.element.querySelectorAll('[data-resources-grid-target="nameTarget"]:not(.is-tipped)');r.e(52).then(r.bind(null,521)).then((function(r){(0,r.default)(n,{content:'<div class="ez-spinner ez-spinner--sm ez-spinner--color-mono"></div>',allowHTML:!0,animation:"rising",interactive:!0,appendTo:document.body,placement:"bottom-start",theme:"contrib-info",delay:[250,null],duration:0,onCreate:function(t){t.popper.classList.add("contributor-info-tooltip")},onShow:function(t){e.tippyInstance=t,e.showTooltip(),t.popper.addEventListener("mouseleave",e.stopPreviewVideo)},onHide:function(t){e.tippyInstance=t,e.hideTooltip(),t.popper.removeEventListener("mouseleave",e.stopPreviewVideo)}}),t.tooltipsInitialized=!0})),n.forEach((function(t){t.classList.add("is-tipped")}))}},t.stopPreviewVideo=function(e){var r=t.getParentLi(t.tippyInstance.reference);t.newTargetIsPreview(e.relatedTarget)||r.classList.remove("is-playing")},t.injectTooltipContent=function(){if(t.contributorsInfo||t.pageGrids.length>1){clearInterval(t.contributorsInfoPolling);var e=t.contribInfoTemplateTarget.innerHTML,r=t.parseTemplateForContributor(e);setTimeout((function(){t.initTooltipContent(r)}),0)}},t.clickThroughToProfile=function(){t.trackContributorClick()},t}return e=b,(n=[{key:"connect",value:function(){this.hasContribInfoTemplateTarget&&this.contributorsIds.length&&this.setupMediaQueries(),this.hasContribThumbnailsTarget&&this.setupFollowingThumbnails(),y.evaluateAll(),y.addListeners(),window.addEventListener("setNewThumbnailContributorInfo",this.setNewThumbnailInfo)}},{key:"disconnect",value:function(){y.removeListeners(),y.clearQueries(),window.removeEventListener("setNewThumbnailContributorInfo",this.setNewThumbnailInfo)}},{key:"setupContribInfoTooltips",value:function(){var t=this;this.pageGrids=document.querySelectorAll('[data-controller*="resources-grid"]:not(.ez-resource-grid--partner)');var e=document.querySelector(".ez-page-wrapper");this.contributorsIds&&(this.hasIdCollectionTarget&&"0"!==this.idCollectionTarget.dataset.featuredGrid||Object(c.b)("/async_contributors_info",(function(r){t.contributorsInfo=r.data,t.pageGrids.length>=1&&e.setAttribute("data-contributors-info",JSON.stringify(r.data))}),(function(t){console.error(t)}),{params:{contributor_ids:this.contributorsIds,preview_count:3}}),this.tooltipsInitialized=!1,y.addMediaQuery("(min-width: 1024px)",this.initTooltips),y.evaluateAll(),y.addListeners())}},{key:"setupFollowingThumbnails",value:function(){var t=this;Object(c.b)("/async_contributors_info",(function(e){t.contributorsInfo=e.data,t.gatherfollowedUsers().forEach((function(e){var r=document.querySelector('[data-user-id="'.concat(e,'"] [data-thumbnail-contributor-info-target="previewsWrap"]')),n=t.contributorsInfo[e].previews,o="";n.forEach((function(e){var r=e.thumb_src,n=e.thumb_src_2x,i=e.resource_path,a=e.resource_title;o+=t.makePreviewThumbHTML(r,n,i,a)})),r.innerHTML=o}))}),(function(t){console.error(t)}),{params:{contributor_ids:this.gatherfollowedUsers(),preview_count:3,sort:"recent"}})}},{key:"contributorsIds",get:function(){return this.hasContribInfoTemplateTarget?JSON.parse(this.contribInfoTemplateTarget.dataset.userIds):null}},{key:"gatherfollowedUsers",value:function(){var t=[];return this.contribThumbnailsTargets.forEach((function(e){t.push(e.dataset.userId)})),t}},{key:"showTooltip",value:function(){this.contributorsInfoPolling=setInterval(this.injectTooltipContent,100),this.injectTooltipContent()}},{key:"hideTooltip",value:function(){clearInterval(this.contributorsInfoPolling);var t=this.getParentLi(this.tippyInstance.reference),e=this.getTooltipHeader(this.tippyInstance.popper);t.classList.remove("is-active"),e&&e.removeEventListener("click",this.clickThroughToProfile)}},{key:"newTargetIsPreview",value:function(t){return!!t.hasAttribute("data-video-preview-target")&&"videoWrap"===t.getAttribute("data-video-preview-target")}},{key:"initTooltipContent",value:function(t){var e=this.getTooltipContent(this.tippyInstance.popper),r=this.getParentLi(this.tippyInstance.reference);e.innerHTML=t,this.fixAvatar(),this.loadPreviewThumbs(),r.classList.add("is-active"),this.getTooltipHeader(this.tippyInstance.popper).addEventListener("click",this.clickThroughToProfile)}},{key:"parseTemplateForContributor",value:function(t){var e=this.contributorInfoById;return e.url=e.contributor_uploads_path,e.src=e.contributor_avatar_src,Object(o.z)(t,e)}},{key:"fixAvatar",value:function(){var t=this.getTooltipContent(this.tippyInstance.popper),e=t.querySelector(".ez-avatar"),r=t.querySelector('[data-thumbnail-contributor-info-target="avatarTemplate"]');this.contributorInfoById.contributor_avatar_src&&(e.classList.remove("ez-avatar--missing"),e.innerHTML=r.innerHTML)}},{key:"loadPreviewThumbs",value:function(){var t=this,e=this.contributorInfoById.previews,r=this.tippyInstance.popper.querySelector('[data-thumbnail-contributor-info-target="previewsWrap"]'),n="";e.forEach((function(e){var r=e.thumb_src,o=e.thumb_src_2x,i=e.resource_path,a=e.resource_title,c=e.pro,s=e.content_type;n+=t.makePreviewThumbHTML(r,o,i,a,s,c)})),r.innerHTML=n}},{key:"makePreviewThumbHTML",value:function(t,e,r,n,o,i){return'<a href="'.concat(r,'"\n               class="ez-resource-grid__item__contrib-info__uploads__thumb"\n               data-content-type="').concat(o,'"\n               data-pro="').concat(i,'"\n               data-action="click->thumbnail-contributor-info#trackResourceClick">\n              <img src="').concat(t,'"\n                   srcset="').concat(e," 2x, ").concat(t,' 1x" alt="').concat(n,'"></a>\n              ')}},{key:"contributorInfoById",get:function(){var t,e=document.querySelector(".ez-page-wrapper"),r=e&&e.hasAttribute("data-contributors-info")?JSON.parse(e.getAttribute("data-contributors-info")):{},n=this.tippyInstance.reference.getAttribute("data-user-id");if(null!==(t=this.contributorsInfo)&&void 0!==t&&t[n]&&r[n]){var o=r[n].contributor_uploads_path;this.contributorsInfo[n]=r[n],this.contributorsInfo[n].url=o}return u(u({},r),this.contributorsInfo||{})[n]}},{key:"getParentLi",value:function(t){return t.closest(".ez-resource-thumb")}},{key:"trackContributorClick",value:function(t){t&&Object(i.k)({element:t.target,data:{action:a.p}})}},{key:"trackResourceClick",value:function(t){var e=t.target.dataset,r=e.contentType,n=e.pro;Object(i.k)({element:t.target,data:{action:a.o,label:Object(o.y)(n)?"Pro":"Free",content_type:"Content-".concat(r)}})}},{key:"getTooltipHeader",value:function(t){return t.querySelector(".tippy-box[data-theme=contrib-info] .contributor-details__contributor")}},{key:"getTooltipContent",value:function(t){return t.querySelector(".tippy-content")}},{key:"setupMediaQueries",value:function(){var t=this;y.addMediaQuery("(min-width: 1024px)",(function(){t.contributorsIds.length&&t.setupContribInfoTooltips()}))}}])&&f(e.prototype,n),s&&f(e,s),b}(n.a);g.targets=["contribInfoTemplate","missingAvatarSvg","contribThumbnails","idCollection","contribInfo","removeFromCollection","hoverTemplate"]}}]);
//# sourceMappingURL=55-78cd6bf933f53216c6c0.chunk.js.map